# Проект по распознаванию кошек
***Над проектом работали:***\
*Горобец Виктория\
Бенджик Илья\
Новиков Иван*

> Фильмы 90-х: совсем скоро искуственный интеллект захватит весь мир!\
Искуственный интеллкт сейчас: собака\
** картинка, на которой изображен кот **\
© мем

## Задачи: 
Обучить нейросеть находить на фотографии кошек и определять их породу
## Процесс:
* Для обучения нейросети был выбран фреймворк **detecton 2**. Обучалась сеть на датасете с *http://cocodataset.org/#home* на видеокарте **nVidia GTX ~~1080~~ 1070**.
* После обучения сеть находила на картинке кота, но обнаружились следующая проблема: нейросеть считала котами собак, белок, других зверей и просто волосы.
* Для устранения данного несдостатка сети было решено "склеить" некоторые размеченные картинки из датасета с фотографиями всяческих зверей. Обучившись на "обновленном" датасете, сеть стала заметно лучше показывать себя в данном направлении.
* Далее, для обучения **второй** сети уже на распознавание пород кошек, было предложено использовать архитектуру **YOLO**, чтобы разметить bbox’ы котов из датасета с породами. Далее на том же **detecton 2** производилось обучение на ~~определение~~ детекцию пород.
* Для более наглядного представления результатов был сделан простенький telegram-bot, получивший гордое имя **@Cat_NN_bot**
* По причине **краха** сервера, на котором производилось обучение сетей, вторая сеть недостаточно обучилась и было принято решение запускать обе сетки поочередно, так, чтобы **первая** рисовала box'ы, а **вторая** писала найденные на картинке породы
## Результаты:
**1. Итог:**\
Есть две нейросети, обе на **detecton 2**, первая имеет 2 выхода (класс кот и класс не кот), вторая - множество (классы - породы котов)\
**2. Примеры работы:**\
Примеры работы бота можно увидеть в файле **results.pdf**\
**3. Значение иных файлов:**\
**resnet.py** - Резнет, часть **detecton 2**, которая отвечает за то, чтобы с помощью матричных сверток получить из изначального изображение какие-то фичи, по которым далее будет определяться принадлежность того или иного объекта на картинке к тому или иному классу
**rpn.py** - Эрпиэн, часть **detecton 2**, отвечающая за создание около каждого пикселя прямоугольничка размером, который задается конфигом, дальнейшего алгоритмического объединения этих прямоугольничков, а затем - прогона через линейные слои и сопоставления каждому прямоугольничку значения количеством выходов сети и объединения прямоугольничков\
**my_Detection.yaml** - конфиг, по которому **detectron 2** восстанавливает архитектуру сети
**model.pbtxt** - архитектура сети (файл открывается приложением **Netron.exe**)
**main.py** - кот telegram-bot'а
**dataset_sbs_1.ipynb** - ноутбук, в котором производилось слияние картинок из датасета с котами с картинками других зверей
**dataset_sbs_from_yolo.ipynb** - ноутбук, в котором производилось приведение в пригодный для "скармливания" нейросети вид датасета с породами, размеченными с помощью **YOLO**
